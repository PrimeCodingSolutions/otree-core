{% extends "global/Base.html" %}
{% load otree %}
{% block content %}
    <style>
        body {
            background: #41739D;
        }

        ._otree-content {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #timer {
            display: flex;
            justify-content: center;
        }
    </style>

    <div class="daytrader-game-container">
        <p class="daytrader-round-info">
            Nu kan du starte med at handle.
        </p>
        <p class="daytrader-round-info">
            Du kan kun trykke på et af tradernes ansigter og få vist deres private information. Denne information er
            usynlig for andre traders.
        </p>
        <p class="daytrader-round-info">
            Du ved dog, at de to første tradere også fik lov at se et ansigt inden de lavede deres handel. Og du kan se
            hvor meget de gik short eller long i tabellen her:
        </p>
        <p class="daytrader-round-info">
            (Minus er <i class="short-modal-link">short</i>, plus er <i class="long-modal-link">long</i>)
        </p>

        <table class="table daytrader-table intro-table">
            <tr class="table-corners">
                <th class="daytrader-table-header border-corner-left">trader</th>
                <th class="daytrader-table-header">pris</th>
                <th class="daytrader-table-header">ansigt</th>
                <th class="daytrader-table-header border-corner-right">handel</th>
            </tr>
            <tr class="daytrader-table-row">
                <td class="daytrader-table-data"> {{ 1 }}.</td>
                <td class="daytrader-table-data"> {{ 50|c }}</td>
                <td class="daytrader-table-data" id="faceContainer1">
                    <img src="{% static 'daytrader/media/unknown_face_daytrader.png' %}" alt="unknown face"
                         class="reveal-face" id="unknownFace1">
                </td>
                <td class="daytrader-table-data"> +23 aktier</td>
            </tr>
            <tr class="daytrader-table-row">
                <td class="daytrader-table-data"> {{ 2 }}.</td>
                <td class="daytrader-table-data"> {{ 50.06|c }}</td>
                <td class="daytrader-table-data" id="faceContainer2">
                    <img src="{% static 'daytrader/media/unknown_face_daytrader.png' %}" alt="unknown face"
                         class="reveal-face" id="unknownFace2">
                </td>
                <td class="daytrader-table-data"> +45 aktier</td>
            </tr>
        </table>
        <div class="daytrader-intro-info-container">
            <p class="daytrader-round-info">
                Du er den tredje til at trade i dette firma, du kigger i sækken og ser at din private information om
                firmaet
                er et <img src="{% static 'daytrader/media/sad_face_daytrader.png' %}" alt="sad face"
                           class="company-face">
                ansigt.
            </p>
            <p class="daytrader-round-info">
                Du har {{ player.wallet|c }} og aktieprisen er {{ player.price|c }}, hvad vil du gøre?
            </p>
        </div>

        <div class="daytrader-intro-info-container">
            <p class="daytrader-round-info">
                De to forrige tradere har begge købt aktier i firmaet så du konkludere at de begge har haft
                <img src="{% static 'daytrader/media/happy_face_daytrader.png' %}" alt="happy face"
                     class="company-face">
                ansigter.
            </p>
            <p class="daytrader-round-info">
                Du tror derfor nu at firmaets tilstand er 2
                <img src="{% static 'daytrader/media/happy_face_daytrader.png' %}" alt="happy face"
                     class="company-face">
                ansigter og 1 <img src="{% static 'daytrader/media/sad_face_daytrader.png' %}" alt="sad face"
                                   class="company-face">
                ansigt. Det ville derfor være fornuftigt at gå long.
            </p>
        </div>
        <div class="daytrader-next-btn-container">
            <button class="daytrader-next-btn" id="goLong">
                Gå long
            </button>
        </div>
        <div class="go-long-content">
            <p class="daytrader-round-info long-info">
                Du gik long og købte 30 aktier i firmaet.
            </p>
            <table class="table daytrader-table intro-table">
                <tr class="table-corners">
                    <th class="daytrader-table-header border-corner-left">trader</th>
                    <th class="daytrader-table-header">pris</th>
                    <th class="daytrader-table-header">ansigt</th>
                    <th class="daytrader-table-header border-corner-right">handel</th>
                </tr>
                <tr class="daytrader-table-row">
                    <td class="daytrader-table-data"> {{ 1 }}.</td>
                    <td class="daytrader-table-data"> {{ 50|c }}</td>
                    <td class="daytrader-table-data">
                        <img src="{% static 'daytrader/media/unknown_face_daytrader.png' %}" alt="unknown face"
                             class="reveal-face">
                    </td>
                    <td class="daytrader-table-data"> +23 aktier</td>
                </tr>
                <tr class="daytrader-table-row">
                    <td class="daytrader-table-data"> {{ 2 }}.</td>
                    <td class="daytrader-table-data"> {{ 50.06|c }}</td>
                    <td class="daytrader-table-data">
                        <img src="{% static 'daytrader/media/unknown_face_daytrader.png' %}" alt="unknown face"
                             class="reveal-face">
                    </td>
                    <td class="daytrader-table-data"> +45 aktier</td>
                </tr>
                <tr class="daytrader-table-row">
                    <td class="daytrader-table-data"> {{ 3 }}.</td>
                    <td class="daytrader-table-data"> {{ 50.26|c }}</td>
                    <td class="daytrader-table-data">
                        <img src="{% static 'daytrader/media/sad_face_daytrader.png' %}" alt="happy face"
                             class="company-face" id="introFace3">
                    </td>
                    <td class="daytrader-table-data"> +30 aktier</td>
                </tr>
            </table>
        </div>
        <div class="daytrader-next-btn-container">
            <button class="daytrader-next-btn" id="continue">
                Fortsæt...
            </button>
        </div>
        <div id="shortModal" class="short-modal">
            <div class="short-modal-content">
                <p class="daytrader-round-info">Når man går short betyder bla bla bla</p>
            </div>
        </div>
        <div id="longModal" class="long-modal">
            <div class="long-modal-content">
                <p class="daytrader-round-info">Når går long betyder bla bla bla</p>
            </div>
        </div>
    </div>

    <script>
        let shortModal = document.getElementById("shortModal");
        let longModal = document.getElementById("longModal");
        let shortLink = document.querySelector(".short-modal-link");
        let longLink = document.querySelector(".long-modal-link");
        let unknownFace1 = document.getElementById("unknownFace1");
        let unknownFace2 = document.getElementById("unknownFace2");
        let goLong = document.getElementById("goLong");
        let goLongContent = document.querySelector(".go-long-content");
        let continueBtn = document.getElementById("continue");
        let faceContainer1 = document.getElementById("faceContainer1");
        let faceContainer2 = document.getElementById("faceContainer2");

        unknownFace1.onclick = () => {
            unknownFace1.style.display = "none";
            unknownFace2.style.display = "none";
            let introFace1 = document.createElement("img");
            introFace1.src = "{% static 'daytrader/media/happy_face_daytrader.png' %}";
            introFace1.className = "company-face";
            faceContainer1.appendChild(introFace1);
        }

        unknownFace2.onclick = () => {
            unknownFace1.style.display = "none";
            unknownFace2.style.display = "none";
            let introFace2 = document.createElement("img");
            introFace2.src = "{% static 'daytrader/media/happy_face_daytrader.png' %}";
            introFace2.className = "company-face";
            faceContainer2.appendChild(introFace2);
        }

        goLong.onclick = event => {
            event.preventDefault();
            goLongContent.style.display = "block";
            continueBtn.style.display = "block";
        }


        shortLink.onclick = function () {
            shortModal.style.display = "block";
        }

        longLink.onclick = function () {
            longModal.style.display = "block";
        }

        window.onclick = function (event) {
            if (event.target === shortModal) {
                shortModal.style.display = "none";
            } else if (event.target === longModal) {
                longModal.style.display = "none";
            }
        }


    </script>
{% endblock %}
